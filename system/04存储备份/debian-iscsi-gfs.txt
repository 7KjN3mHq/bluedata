ISCSI Target:
apt-get install iscsitarget-modules-2.6.26-2-686 iscsitarget

vi /etc/ietd.conf
Target iqn.2009-05.com.domain:master1.lun1
        IncomingUser username password
        OutgoingUser
        Lun 0 Path=/dev/sdb,Type=fileio
        Alias LUN1

说明：
IncomingUser 和 OutgoingUser 表示 ISCSI 客户端的用户名和密码，用户名和密码都可以为空，默认为 allow 权限，密码最长可为 12 个字符。
Target iqn.2000-12.com.digicola:master1.lun1 表示该ISCSI Target 的命名，命名在同一子网内应该是唯一的，标准命名方式为：
"Target" + target 名字（格式如下： iqn.yyyy-mm.<reversed domain name>[:identifier] ）
"fileio" 用来对一个磁盘进行存储共享。当然也可以设置为 "file" 或 "LVM" 。

参考： http://www.howtoforge.com/using-iscsi-on-debian-lenny-initiator-and-target

vi /etc/default/iscsitarget
ISCSITARGET_ENABLE=true

/etc/init.d/iscsitarget start


ISCSI Initiator:
apt-get install open-iscsi

vi /etc/iscsi/iscsid.conf
node.startup = automatic
...
node.session.auth.authmethod = CHAP
node.session.auth.username = username
node.session.auth.password = password

vi /etc/iscsi/initiatorname.iscsi
InitiatorName=iqn.2009-05.com.domain:master1.lun1

iscsiadm -m discovery -t sendtargets -p 192.168.6.201

查看可使用的 iscsitarget
iscsiadm -m node
192.168.6.201:3260,1 iqn.2009-05.com.domain:master1.lun1

登录到 iscsitarget
iscsiadm -m node -l

注销 iscsi 登录
iscsiadm -m node -u

删除失效的 iscsi 连接
iscsiadm -m node -o delete -T iqn.2009-05.com.domain:master2.lun1 -p 192.168.6.202


GFS:
apt-get install redhat-cluster-modules-2.6.26-2-686 cman gfs-tools clvm
(rhcs rpm: ccs cman-kernel-smp dlm dlm-kernel-smp fence iddev magma magma-plugins gulm perl-Net-Telnet)
(gfs rpm: GFS GFS-kernel-smp lvm2-cluster)

The following NEW packages will be installed:
  clvm cman file gfs-tools gfs2-tools libcman2 libdb4.5 libdlm2 libmagic1 libnet-snmp-perl libnet-telnet-perl libnspr4-0d libnss3-1d
  libopenais2 libsgutils1 libsqlite3-0 libvirt0 libxenstore3.0 libxml2 mime-support openais python python-central python-minimal
  python-pexpect python2.5 python2.5-minimal redhat-cluster-modules-2.6.26-2-686 sg3-utils sgml-base xml-core

mkdir /etc/cluster
vi /etc/cluster/cluster.conf
<?xml version="1.0"?>
<cluster name="alpha_cluster" config_version="1">

<cman two_node="1" expected_votes="1">
</cman>

<clusternodes>
<clusternode name="ld1" votes="1">
<fence>
<method name="human">
<device name="human" nodename="ld1"/>
</method>
</fence>
</clusternode>

<clusternode name="ld2" votes="1">
<fence>
<method name="human">
<device name="human" nodename="ld2"/>
</method>
</fence>
</clusternode>
</clusternodes>

<fencedevices>
<fencedevice agent="fence_vmware_ng" ipaddr="192.168.0.254:8333" login="Administrator" name="ld1" passwd="password" port="ld1"/>
<fencedevice agent="fence_vmware_ng" ipaddr="192.168.0.181:8333" login="Administrator" name="ld2" passwd="password" port="ld2"/>
</fencedevices>

</cluster>

vi /etc/hosts
192.168.6.11    ld1.domain.com  ld1
192.168.6.12    ld2.domain.com  ld2

fence_vmware_ng: http://sources.redhat.com/cluster/wiki/VMware_FencingConfig

apt-get install libxml-libxml-perl libcrypt-ssleay-perl libclass-methodmaker-perl
The following NEW packages will be installed:
  libclass-methodmaker-perl libcompress-raw-zlib-perl libcompress-zlib-perl libcrypt-ssleay-perl libexpat1 libfont-afm-perl
  libhtml-format-perl libhtml-parser-perl libhtml-tagset-perl libhtml-tree-perl libio-compress-base-perl libio-compress-zlib-perl
  libmailtools-perl libtimedate-perl liburi-perl libwww-perl libxml-libxml-common-perl libxml-libxml-perl libxml-namespacesupport-perl
  libxml-parser-perl libxml-sax-expat-perl libxml-sax-perl ucf

tar zxvf VMware-VIPerl-1.6.0-104313.i386.tar.gz
cd vmware-viperl-distrib
./vmware-install.pl

tar zxvf vmware-ng.tar.gz
cd vmware-ng/agent-itself/sbin
chown root:root fence_vmware_ng*
chmod 755 fence_vmware_ng*
cp -a fence_vmware_ng* /usr/sbin/
cp -r ../../library-forRHEL52/usr/lib/fence /usr/lib/

fence_vmware_ng -a 192.168.0.254:8333 -l Administrator -p password -n 'master1' -o status -v

/etc/init.d/cman restart

cman_tool status
ccs_tool lsnode
ccs_tool lsfence
cman_tool services

vi /etc/lvm/lvm.conf
filter = [ "r|/dev/cdrom|", "a|/dev/sda|", "a|/dev/sdb|", "r|.*|" ]
...
locking_type = 3

/etc/init.d/clvm restart

只在一个节点上执行如下操作：
pvcreate /dev/sdb
vgcreate gfs /dev/sdb
lvcreate -l 127 -n home gfs
mkfs.gfs -j 2 -p lock_dlm -t alpha_cluster:gfs /dev/gfs/home

mount -t gfs -o noatime,nodiratime /dev/gfs/home /home
dd if=/dev/zero of=/home/test bs=1024k count=100