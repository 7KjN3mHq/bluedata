mkdir /package
cd /package
wget http://www.bluedata.org/software/linux/extqmail/daemontools-0.76.tar.gz
wget http://www.bluedata.org/software/linux/extqmail/patches/daemontools-0.76.errno.patch
tar zxvf daemontools-0.76.tar.gz
cd admin/daemontools-0.76/src
patch < ../../../daemontools-0.76.errno.patch
cd ..
package/install

rm -rf /command
cd command
sed -e 's|/command:||' \
    -e 's|command|usr/local/bin|' \
    -e 's|/service|/etc/service|g' svscanboot > svscanboot~
mv -f svscanboot~ svscanboot
chmod 755 svscanboot
cp -af * /usr/local/bin/
sed 's|command|usr/local/bin|' /etc/inittab > /etc/inittab~
mv -f /etc/inittab~ /etc/inittab
mkdir /etc/service
telinit q
rm -rf /service /package

mkdir /etc/service/mysql-proxy
vi /etc/service/mysql-proxy/run
#!/bin/sh
export LUA_PATH=/usr/local/share/mysql-proxy/?.lua
/usr/local/sbin/mysql-proxy \
--proxy-address=:3306 \
--proxy-backend-addresses=192.168.0.250:3306 \
--proxy-read-only-backend-addresses=192.168.0.10:3307 \
--proxy-lua-script=/usr/local/share/mysql-proxy/rw-splitting.lua

chmod 755 /etc/service/mysql-proxy/run

supervise /etc/service/mysql-proxy

vi /etc/inittab
#SV:123456:respawn:/usr/local/bin/svscanboot

vi /etc/rc.local
/usr/local/bin/supervise /etc/service/mysql-proxy &


CentOS °²×°£º
http://www.qmail.org/rpms/daemontools.html
http://untroubled.org/supervise-scripts/

wget http://www.qmail.org/rpms/RPMS/daemontools-0.76-112memphis.i386.rpm
wget http://untroubled.org/supervise-scripts/supervise-scripts-3.5-1.noarch.rpm

rpm -Uvh daemontools-0.76-112memphis.i386.rpm supervise-scripts-3.5-1.noarch.rpm

vi /etc/inittab
SV:123456:respawn:env - PATH=/usr/local/bin:/usr/sbin:/usr/bin:/bin svscan /service < /dev/null > /dev/console 2> /dev/console

telinit q
ps -ef | grep svscan