http://www.lua.org/

http://mysql.cdpa.nsysu.edu.tw/Downloads/MySQL-Proxy/

yum -y install readline-devel

tar zxvf lua-5.1.3.tar.gz
cd lua-5.1.3
make linux
make install

tar zxvf mysql-proxy-0.6.1-linux-rhel4-x86-32bit.tar.gz
cd mysql-proxy-0.6.1-linux-rhel4-x86-32bit

mv sbin/mysql-proxy /usr/local/sbin/
mv share/mysql-proxy /usr/local/share/
strip /usr/local/sbin/mysql-proxy

vi /etc/init.d/mysql-proxy
#!/bin/sh
export LUA_PATH=/usr/local/share/mysql-proxy/?.lua

mode=$1
if [ -z "$mode" ] ; then
  mode="start"
fi

case $mode in
  'start')
/usr/local/sbin/mysql-proxy --daemon \
--proxy-address=:3306 \
--proxy-backend-addresses=:3307 \
--proxy-read-only-backend-addresses=192.168.0.162:3307 \
--proxy-read-only-backend-addresses=192.168.0.161:3307 \
--proxy-lua-script=/usr/local/share/mysql-proxy/rw-splitting.lua
    ;;

  'stop')
    killall mysql-proxy
    ;;

  'restart')
    if $0 stop ; then
      $0 start
    else
      echo  "retart failed!!!"
      exit 1
    fi
    ;;
esac
exit 0

chmod +x /etc/init.d/mysql-proxy