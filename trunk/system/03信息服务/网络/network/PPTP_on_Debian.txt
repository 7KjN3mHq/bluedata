Debian Linux PPTP VPN 安装设置 (Linode VPS)

1. 安装 PPTP VPN
apt-get update
apt-get upgrade
apt-get install pptpd

2. 配置PPTP VPN
编辑 /etc/pptpd.conf ，修改 localip, remoteip 的 ip 地址段，例如修改为：
localip 192.168.168.1
remoteip 192.168.168.168-248

编辑 /etc/ppp/pptpd-options ，修改 ms-dns 的 dns 地址，例如修改为：
ms-dns 8.8.8.8
ms-dns 8.8.4.4

编辑 /etc/ppp/chap-secrets ，设置用户名密码，格式如下：
user1 pptpd password1 *
user2 pptpd password2 192.168.168.168

格式一为不限定分配 ip 地址，格式二为限定分配 ip 地址。

编辑 /etc/sysctl.conf ，修改 #net.ipv4.ip_forward=1 为 net.ipv4.ip_forward=1 ，执行如下命令：
sysctl -p

3. iptables 防火墙设置
iptables -A INPUT -p gre -j ACCEPT
iptables -A OUTPUT -p gre -j ACCEPT
iptables -A INPUT -p tcp --sport 1723 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 1723 -j ACCEPT
iptables -t nat -A POSTROUTING -s 192.168.168.0/24 -o eth0 -j MASQUERADE

Debian 默认防火墙是全通的，因此前四行可以不执行。建议将第五行加入到 /etc/rc.local 。

4. Linode 设置
由于 Linode VPS 没有 ppp 设备，需要执行如下命令：
mknod /dev/ppp c 108 0

5. 启动 PPTP 服务
执行如下命令，启动PPTP服务：
/etc/init.d/pptpd restart